
{% load static %} {% block title %} {% endblock %} {% block content %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestionar horario</title>
    <link rel="stylesheet" href="{% static 'css/asignacionCargaLectiva.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
<body style="background-color: #E2E3E5;">
  <div class="container-fluid p-0 m-auto">
    <nav class="navbar navbar-expand bg-white mx-auto">
      <div class="container-fluid w-100 d-block">
        <div class="row">
          <div class="col-lg-3 col-md-3 col-sm-6 m-auto my-2">
            <a class="navbar-brand" href="/inicio">
              <img class="img-fluid ms-1 me-4" src="http://www.usat.edu.pe/web/wp-content/uploads/2023/05/logo_usat25.png" alt="Logo usat">
            </a>
          </div>
          <div class="col-lg-5 col-md-5 col-sm-6 m-auto">
            <h3><strong>Bienvenido, NICHO</strong><br /><h6 style="color: #909090	;">Realiza tus procesos ahora!</h6></h3>
          </div>
          <div class="col-lg-4 col-md-4 col-sm-12 my-sm-4 mx-auto">
            <div class="container-fluid w-100 d-block">
              <div class="row">
                <div class="col-3 m-auto p-0 text-end">
                  <button type="button" class="btn position-relative mb-0 p-0 mt-3">
                    <i class="fa fa-bell-o mt-3 me-2"></i>
                    <span class="position-absolute top-0 translate-middle badge rounded-pill bg-dark mt-1" style="left: 82%;">4</span>
                  </button>
                </div>
                <div class="col-9 m-auto p-0 text-center">
                  <div class="container-fluid">
                    <div class="row">
                      <div class="col-4 mx-0 p-0 d-block text-end">
                        <img class="rounded-circle img-fluid h-75 mt-xl-3 mt-md-3 mt-sm-2 mx-0" style="width: 35%;" alt="user" src="https://mdbcdn.b-cdn.net/img/new/avatars/1.webp"/>
                      </div>
                      <div class="col-8 mx-0 p-0">
                        <div class="dropdown d-block text-start mt-xl-3 mt-md-3 mt-sm-2">
                          <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Ernesto, Nicho
                          </button>
                          <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Perfil</a></li>
                            <li><a class="dropdown-item" href="#">Ajustes</a></li>
                            <li><a class="dropdown-item" href="#">Cerrar sesión</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <div class="container-fluid overflow-hidden">
      <div class="row vh-100 overflow-auto">

        <div id="sidebar" class="collapse collapse-horizontal show col-12 col-sm-3 col-xl-2 px-sm-2 px-0 bg-danger" style="width: 230px;">
          <div id="sidebar-nav" class="flex-sm-column flex-row flex-grow-1 align-items-center align-items-sm-start px-3 pt-2 text-white sticky-top">
            <ul class="nav nav-pills flex-sm-column flex-row flex-nowrap flex-shrink-1 flex-sm-grow-0 flex-grow-1 mb-sm-auto mb-0 justify-content-center align-items-center align-items-sm-start" id="menu">
              <div class="mt-3">
                <br>
                <a class="btn shadow-none border-0 text-white" data-bs-toggle="collapse" href="#menuHorario" role="button" aria-expanded="false" aria-controls="menuHorario">
                  <i class="fs-4 my-0 py-0 fa fa-calendar me-2"></i><span class="my-auto ms-2 d-none d-sm-inline text-white">Horario</span>
                </a>
                <div class="collapse" id="menuHorario">
                  <ul class="list-unstyled ps-4">
                    <br>
                    <li><a href="/inicio" class="text-white">Gestionar horario</a></li>
                    <br>
                    <li><a href="/asignacion_docente" class="text-white">Generar horario</a></li>
                    <br>
                      <li><a  href="{% url  'menu_horario' %}"  class="text-white">Reportes</a></li>
                  </ul>
                </div>
              </div>
              <div class="mt-3">
                <a class="btn shadow-none border-0 text-white" data-bs-toggle="collapse" href="#menuCurso" role="button" aria-expanded="false" aria-controls="menuCurso">
                  <i class="fs-4 my-0 py-0 fa fa-book me-2"></i><span class="my-auto ms-2 d-none d-sm-inline text-white">Curso</span>
                </a>
                <div class="collapse" id="menuCurso">
                  <ul class="list-unstyled ps-4">
                      <br>
                    <li><a href="/grupoHorario" class="text-white">Asignar grupos horarios a cursos</a></li>
                    <br>
                     <li><a  href="{% url  'menu_curso' %}"  class="text-white">Reportes</a></li>                    <!-- <br> -->
                    <!-- <li><a href="#" class="text-white">Submenú 3</a></li> -->
                  </ul>
                </div>
              </div>
              <div class="mt-3">
                <a class="btn shadow-none border-0 text-white" data-bs-toggle="collapse" href="#menuDocente" role="button" aria-expanded="false" aria-controls="menuDocente">
                  <i class="fs-4 my-0 py-0 fa fa-users me-2"></i><span class="my-auto ms-2 d-none d-sm-inline text-white">Docente</span>
                </a>
                <div class="collapse" id="menuDocente">
                  <ul class="list-unstyled ps-4">
                      <br>
                    <li><a href="/asignacionCargaLectiva" class="text-white">Asignar docentes a grupo horario</a></li>
                    <br>
                    <li><a href="/csv" class="text-white">Disponibilidad docente</a></li>
                    <br>
                      <li><a  href="{% url  'menu_docente' %}"  class="text-white">Reportes</a></li>
                  </ul>
                </div>
              </div>
              <div class="mt-3">
                <a class="btn shadow-none border-0 text-white" data-bs-toggle="collapse" href="#menuAmbiente" role="button" aria-expanded="false" aria-controls="menuAmbiente">
                  <i class="fs-4 my-0 py-0 fa fa-building me-2"></i><span class="my-auto ms-2 d-none d-sm-inline text-white">Ambiente</span>
                </a>
                <div class="collapse" id="menuAmbiente">
                  <ul class="list-unstyled ps-4">
                    <br>
                    <li><a href="/asignarAmbiente" class="text-white">Asignar ambiente a escuela</a></li>
                    <br>
                    <li><a href="/csvAmbientes" class="text-white">Importar ambientes</a></li>
                    <br>
                      <li><a  href="{% url  'menu_ambiente' %}"  class="text-white">Reportes</a></li>
                  </ul>
                </div>
              </div>
              <hr class="solid w-100 d-flex h-100 border border-1 bg-white dropdown-divider mt-5" color="white">
              <div class="mt-3 mb-3">
                <a class="btn shadow-none border-0 pb-3 text-white" href="/" role="button">
                  <i class="fs-4 my-0 py-0 fa fa-sign-out me-2"></i><span class="my-auto ms-2 d-none d-sm-inline text-white">Salir</span>
                </a>
              </div>
            </ul>
          </div>
        </div>
      

          <div class="col d-flex flex-column h-sm-100">
              <main class="row overflow-auto">
                <div class="container-fluid col">
                  <h1 class="text-start pt-4 pb-2 px-lg-2 mx-lg-2">                
                    <a href="#" data-bs-target="#sidebar" data-bs-toggle="collapse" class="rounded-3 p-1 text-decoration-none"><i class="fa fa-arrow-circle-left" style="color: red;"></i></a>
                    Gestionar horario</h1> 
                  <div class="px-lg-2 mx-lg-2 mb-3">

                    <div class="box-form" >
    
                      <form id="form_lectiva" method="post" action="{% url 'gestionarHorario' %}">
                         
                          {% csrf_token %}
                          
                          <div class="form-row">
                              
                              <div class="col-md-4">
                                  <label for="ciclo_ac">Semestre: </label>
                                  <select name="ciclo_ac" id="ciclo_ac">
                                      <option value="">Selecciona un semestre</option>
                                      {% for ciclo in ciclo_select %}
                                      <option value="{{ ciclo }}" {% if ciclo == ciclo_seleccionado %}selected{% endif %}>
                                          {{ ciclo }}
                                      </option>
                                      {% endfor %}
                                  </select>
                              </div>
                              
                              <div class="col-md-8" style="margin-top: 20px;">
                                  <label for="esc">Escuela: </label>
                                  <select name="esc" id="esc">
                                      <option value="">Selecciona una escuela</option>
                                      {% for escuela in escuela_select %}
                                      <option value="{{ escuela.nombre_escuela }}" {% if escuela.nombre_escuela == escuela_seleccionada%}selected{% endif %}>{{ escuela.nombre_escuela }}
                                      </option>
                                      {% endfor %}
                                  </select>
                              </div>
              
                          </div>
              
                      </form>
                  </div>
                  



                    <div class="container-fluid">
                      <div class="row px-1">
                        <div class="mx-0 col-xl-6 col-lg-6 col-sm-12 col-md-12" style="padding-left: 0; padding-right: 0.5%;">
                          <h5 class="justify-content-start">Cursos</h5>  
                          <div class="border border-black border-1" style="padding-left: 2.1%; padding-right: 2.1%; padding-top: 1.7%;">          
                            <table class="table table-sm align-middle table-borderless w-100 mx-auto">
                              <tbody>
                                
                                <tr  class="table-secondary">
                                  <td colspan="2">
                                    <div class="overflow-auto" style="max-height: 170px;">
                                      <table >
                                        <thead>
                                          <tr >
                                            <th scope="col">Ciclo</th>
                                            <th scope="col">Curso</th>
                                            <th scope="col">Grupo</th>
                                            <th scope="col">Ambiente</th>
                                            <th scope="col">Docente</th>
                                            <th scope="col">H.I</th>
                                            <th scope="col">H.F</th>
                                            <th scope="col">Dia</th>
                                          </tr>
                                        </thead>
                                        <tbody>

                                          {% for cur in cursos %}
                                          <tr  class="table-secondary" onclick="selectRow(this)">
                                            <td class="inputs" style="width: 10%;"> {{cur.1}}</td>
                                            <td class="inputs" style="width: 300px;">{{cur.2}}</td>
                                            <td class="inputs" style="width: 300px;">{{cur.3}}</td>
                                            <td class="inputs" style="width: 300px;">{{cur.4}}</td>
                                            <td class="inputs" style="width: 300px;">{{cur.5}}</td>
                                            <td class="inputs" style="width: 300px;">{{cur.6}}</td>
                                            <td class="inputs" style="width: 300px;">{{cur.7}}</td>
                                            <td class="inputs" style="width: 300px;">{{cur.8}}</td>
                                            
                                            <input id="hor_id" value="{{ cur.9 }}" hidden> 
                                            <input id="gh_id" value="{{ cur.0 }}" hidden> 
                                            
                                          </tr>

                                          {% endfor %}
                                        </tbody>
                                      </table>
                                    </div>
                                  </td>
                                </tr>

                                <tr  class="table-secondary">
                                  <th scope="row" style="width: 15%; margin-left: -50px;">        
                                    <label for="labelDocenteCurso" class="form-label mx-auto pt-2 my-auto">Docente</label>
                                  </th>
                                  <td style="width: 85%; margin-left: -50px;">
                                    <div class="container-fluid my-auto mx-0 px-0 pt-2">
                                      <input id="inputDocenteCurso" type="text" class="form-control mx-auto" placeholder="Docente" disabled>
                                    </div>
                                  </td>
                                </tr>

                              </tbody>
                            </table>
                          </div>
                        </div>
                        <div class="mx-0 col-xl-6 col-lg-6 col-sm-12 col-md-12" style="padding-left: 0.5%; padding-right: 0;">
                          <h5 class="justify-content-start pt-xl-0 pt-lg-0 pt-md-3 pt-sm-3">Horario</h5> 
                          <div class="border border-black border-1" style="padding-left: 2.1%; padding-right: 0; padding-top: 1.7%;">
                            <table class="table table-sm align-middle table-borderless w-100 mx-auto mt-0">
                              <tbody>
                                <tr  class="table-secondary">
                                  <th scope="row" style="width: 18.5%">        
                                    <label for="labelCursoHorario" class="form-label mx-0 px-0 my-auto w-100 m-lg-1 m-sm-1">Curso</label>
                                  </th>
                                  <td colspan="4" style="width: 81.5%">
                                    <div class="container-fluid my-auto">
                                      <input id="inputCursoHorario" type="text" class="form-control mx-auto w-100" placeholder="Curso" disabled >
                                    </div>
                                  </td>
                                </tr>
                                <tr  class="table-secondary">
                                  <td colspan="4">
                                    <table class="table table-sm align-middle table-borderless mx-auto my-0 py-0 w-100">
                                      <tr  class="table-secondary">
                                        <th scope="row" style="width: 18%">        
                                          <label for="labelCicloHorario" class="form-label mx-0 px-0 w-100">Ciclo</label>
                                        </th>
                                        <td style="width: 30%">
                                          <div class="container-fluid my-auto">
                                            <input id="inputCicloHorario" type="text" class="form-control mx-auto" placeholder="Ciclo" disabled>
                                          </div>
                                        </td>
                                        <td style="width: 22%">        
                                          <label for="labelGrupoHorario" class="form-label mx-auto"><strong>Grupo horario</strong></label>
                                        </td>
                                        <td style="width: 30%">
                                          <div class="container-fluid my-auto mx-auto">
                                            <input id="inputGrupoHorario" type="text" class="form-control" placeholder="Grupo horario" disabled>
                                          </div>
                                        </td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                                <tr  class="table-secondary">
                                  <th scope="row" style="width: 14%">        
                                    <label for="labelCursoHorario" class="form-label mx-0 px-0 my-auto w-100 m-lg-1 m-sm-1">Día</label>
                                  </th>
                                  <td colspan="4" style="width: 86%">
                                    <div class="container-fluid my-auto">
                                      <select id="valueDiaHorario" class="form-select w-100 mx-0" aria-label="Día">
                                        {% for dd in dias %}
                                        <option value="{{ dd }}">
                                            {{ dd }}
                                        </option>
                                        {% endfor %}
                                      </select>                      
                                    </div>
                                  </td>
                                </tr>
                                <tr  class="table-secondary">
                                  <td colspan="4">
                                    <table class="table table-sm align-middle table-borderless mx-auto w-100 my-0 py-0">
                                      <tr  class="table-secondary">
                                        <th scope="row" style="width: 18%">        
                                          <label for="labelEdificioHorario" class="form-label mx-0 px-0 w-100">Hora inicial</label>
                                        </th>
                                        <td style="width: 32%">
                                          <div class="container-fluid my-auto">
                                            <input id="inputHoraFinal" type="text" class="form-control mx-auto" placeholder="Hora inicial">
                                          </div>
                                        </td>
                                        <td style="width: 18%">        
                                          <label for="labelAmbienteHorario" class="form-label mx-auto"><strong>Hora final</strong></label>
                                        </td>
                                        <td style="width: 32%">
                                          <div class="container-fluid my-auto mx-auto">
                                            <input id="inputHoraInicio" type="text" class="form-control" placeholder="Hora final" >
                                          </div>
                                        </td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                                <tr  class="table-secondary">
                                  <th scope="row" style="width: 18.5%">        
                                    <label for="labelCursoHorario" class="form-label mx-0 px-0 my-auto w-100 m-lg-1 m-sm-1">Ambiente</label>
                                  </th>
                                  <td colspan="4" style="width: 81.5%">
                                    <div class="container-fluid my-auto">
                                      <select id="valueAmbienteHorario" class="form-select w-100 mx-0" aria-label="Ambiente">
                                        {% for am in amb %}
                                        <option value="{{ am }}">
                                            {{ am }}
                                        </option>
                                        {% endfor %}
                                      </select>                      
                                    </div>
                                  </td>
                                </tr>

                                <tr  class="table-secondary">
                                  <td colspan="4">
                                    
                                <br>
                                <br>
                                
                                    <div class="d-flex gap-3 px-3 mb-0 pb-0" style="justify-content: flex-end;">
                                      <form method="post" id="form_asignados">
                                        {% csrf_token %}
                
                                        <div class="btngroup" style="margin-right: 22px; text-align: right;">
                
                                        <button type="button" class="btnCancelar" data-bs-dismiss="modal">Cancelar</button>
                                        <button id="bt1" type="submit" class="btnGuardar">Guardar</button>
                                        
                                        </div>      
                                
                                    </form>
                                    </div>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </main>
          </div>
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js" integrity="sha512-7Pi/otdlbbCR+LnW+F7PwFcSDJOuUJB3OxtEHbg4vSMvzvJjde4Po1v4BR9Gdc9aXNUNFVUY+SK51wWT8WF0Gg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
</body>


<script>
  
//////// SELECCIONAR CICLO, ESCUELA Y FILTRAR //////////

//Enviar datos de ciclo y escuela seleccionada por parte de formulario
document.addEventListener('DOMContentLoaded', function() {
    var cicloSelector = document.getElementById('ciclo_ac');
    var escuelaSelector = document.getElementById('esc');
    var form = document.getElementById('form_lectiva');

    cicloSelector.addEventListener('change', function () {
        if (escuelaSelector.value !== '') {
            form.submit();
        }
    });

    escuelaSelector.addEventListener('change', function () {
        if (cicloSelector.value !== '') {
            form.submit();
        }
    });
});

function selectRow(row) {
  var cells = row.getElementsByClassName('inputs');
            document.getElementById('inputCicloHorario').value = cells[1].textContent.trim();
            document.getElementById('inputCursoHorario').value = cells[0].textContent.trim();
            document.getElementById('inputGrupoHorario').value = cells[2].textContent.trim();
            document.getElementById('valueAmbienteHorario').value = cells[3].textContent.trim();
            document.getElementById('inputDocenteCurso').value = cells[4].textContent.trim();
            document.getElementById('inputHoraInicio').value = cells[6].textContent.trim();
            document.getElementById('inputHoraFinal').value = cells[5].textContent.trim();
            document.getElementById('valueDiaHorario').value = cells[7].textContent.trim();

          }


          
//Enviar docentes asignados
var guardarBtn = document.getElementById("bt1");

guardarBtn.addEventListener("click", function() {

    var cicloSeleccionado = document.getElementById("ciclo_ac").value;
    var escuelaSeleccionada = document.getElementById("esc").value;
    var horid = document.getElementById("horid").value;
    var ambid = document.getElementById("ambid").value;
    var diaid = document.getElementById("diaid").value;
    var grupoid = document.getElementById("grid").value;
    var hini= document.getElementById('inputHoraInicio').value;
    var hfin= document.getElementById('inputHoraFinal').value;

    var hiddenCicloInput = document.createElement('input');
    hiddenCicloInput.type = 'hidden';
    hiddenCicloInput.name = 'ciclo_seleccionado';
    hiddenCicloInput.value = cicloSeleccionado;

    var hiddenEscuelaInput = document.createElement('input');
    hiddenEscuelaInput.type = 'hidden';
    hiddenEscuelaInput.name = 'escuela_seleccionada';
    hiddenEscuelaInput.value = escuelaSeleccionada;

    var hiddenIdInput = document.createElement('input');
    hiddenIdInput.type = 'hidden';
    hiddenIdInput.name = 'hor_id'; 
    hiddenIdInput.value = horid; 

    var hiddenIdInput = document.createElement('input');
    hiddenIdInput.type = 'hidden';
    hiddenIdInput.name = 'ambid'; 
    hiddenIdInput.value = ambid; 


    var hiddenIdInput = document.createElement('input');
    hiddenIdInput.type = 'hidden';
    hiddenIdInput.name = 'diaid'; 
    hiddenIdInput.value = diaid; 

    var hiddenIdInput = document.createElement('input');
    hiddenIdInput.type = 'hidden';
    hiddenIdInput.name = 'grid'; 
    hiddenIdInput.value = grid; 


    var hiddenIdInput = document.createElement('input');
    hiddenIdInput.type = 'hidden';
    hiddenIdInput.name = 'hini'; 
    hiddenIdInput.value = hini; 


    var hiddenIdInput = document.createElement('input');
    hiddenIdInput.type = 'hidden';
    hiddenIdInput.name = 'hfin'; 
    hiddenIdInput.value = hfin; 


    var formulario = document.getElementById('form_asignados'); 
    formulario.appendChild(hiddenIdInput);
    formulario.appendChild(hiddenCicloInput);
    formulario.appendChild(hiddenEscuelaInput);

    //Enviar el formulario
    formulario.submit();
});




</script>
</html>

{% endblock %}